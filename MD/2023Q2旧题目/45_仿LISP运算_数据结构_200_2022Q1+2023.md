## 题目

> LISP 语言唯一的语法就是括号要配对。
>
> 形如 (OP P1 P2 …)，括号内元素由单个空格分割。
>
> 其中第一个元素 OP 为操作符，后续元素均为其参数，参数个数取决于操作符类型。
>
> **注意：**
>
> 参数 P1, P2 也有可能是另外一个嵌套的 (OP P1 P2 …) ，
>
> 当前 OP 类型为 add / sub / mul / div（全小写），分别代表整数的加减乘除法，
>
> 简单起见，所有 OP 参数个数均为 2 。
>
> **举例:**
>
> 输入：(mul 3 -7)
>
> 输出：-21
>
> 输入：(add 1 2)
>
> 输出：3
>
> 输入：(sub (mul 2 4) (div 9 3))
>
> 输出：5
>
> 输入：(div 1 0)
>
> 输出：error
>
> **题目涉及数字均为整数，可能为负；**
>
> **不考虑 32 位溢出翻转，计算过程中也不会发生 32 位溢出翻转，**
>
> **除零错误时，输出 “error”，**
>
> **除法遇除不尽，向下取整，即 3/2 = 1**

# 思路

> 1：可以参考 [逆波兰表达式](https://leetcode.cn/problems/evaluate-reverse-polish-
> notation/ "逆波兰表达式") 的解法。
>
> 2：核心还是数据结构：栈的使用方法。
>
>   * 遇到数字，入栈
>   * 遇到符号，弹出两个数，然后计算（栈底的元素在前，栈顶的元素在后面），将计算的结果入栈
>

#

# Code

    
    
    def solve_lisp(lisp_str):
        '''
        解析lisp字符串，返回一个数值
        '''
        # 去掉空格
        lisp_str = lisp_str.strip()
        
        # 去掉括号
        if lisp_str[0] == '(':
            lisp_str = lisp_str[1:]
        if lisp_str[-1] == ')':
            lisp_str = lisp_str[:-1]
    
        # 解析操作符
        op = lisp_str[:3]
        lisp_str = lisp_str[3:]
        
        # 保存解析出来的数值
        nums = []
    
        # 解析括号内的字符串
        i = 0
        while i < len(lisp_str):
            c = lisp_str[i]
            if c.isdigit() or c == '-' or c == '+':
                j = i
                while j < len(lisp_str) and (lisp_str[j].isdigit() or lisp_str[j] == '-' or lisp_str[j] == '+'): # or 需要加括号，否则越界
                    j += 1
                nums.append(int(lisp_str[i:j]))
                i = j
            elif c == '(':
                j = i
                cnt = 0
                while j < len(lisp_str):
                    if lisp_str[j] == '(':
                        cnt += 1
                    elif lisp_str[j] == ')':
                        cnt -= 1
                    j += 1
                    if cnt == 0:
                        break
                nums.append(solve_lisp(lisp_str[i:j]))
                i = j
            else:
                i += 1
    
        if op == 'mul':
            cum = 1
            for num in nums:
                cum *= num
            return cum
        elif op == 'add':
            return sum(nums)
        elif op == 'div':
            return int(nums[0] / nums[1])
        elif op == 'sub':
            return nums[0] - nums[1]
    
    def solve(lisp_str):
        try:
            print(solve_lisp(lisp_str))
        except Exception:
            print('error')
    
    #https://www.cnblogs.com/southtonorth/p/16240761.html
    solve(input())
    

## 要求

> 时间限制：C/C++ 1秒，其他语言 2秒
>
> 空间限制：C/C++262144K，其他语言524288K
>
> 64bit IO Format：%lld
>
> 语言限定：  
>  C（clang11）, C++（clang++11）, Pascal（fpc 3.0.2）, Java（javac 1.8）,
> Python2（2.7.3）,  
>  PHP(7.4.7), C#(mcs5.4), ObjC(gcc 5.4), Pythen3(3.9), JavaScript
> Node(12.18.2), JavaScript V8(6.0.0),  
>  Sqlite(3.7.9), R(4.0.3), Go(1.14.4), Ruby(2.7.1), Swift(5.3), matlab(Octave
> 5.2), Pypy2(pypy2.7.13),  
>  Pypy3(pypy3.6.1), Rust(1.44), Scala(2.11.12), Kotlin(1.4.10),
> Groovy(3.0.6), TypeScript(4.1.2), Mysql(8.0)
>
> **【华为od机试真题Python+JS+Java合集】【超值优惠】： ** ** ** ** ** ** ** ** ** ** ** ** **
> ** **[Py/JS/Java合集](https://blog.csdn.net/misayaaaaa/category_12258991.html
> "Py/JS/Java合集")********************************
>
> **【华为od机试真题Python】： ** ** ** ** ** ** ** ** ** ** ** ** ** **
> **[Python真题题库](https://blog.csdn.net/misayaaaaa/category_12111005.html
> "Python真题题库")********************************
>
> **【华为od机试真题JavaScript】： ** ** ** ** ** ** ** ** ** ** ** ** ** **
> **[JavaScript真题题库](https://blog.csdn.net/misayaaaaa/category_12199270.html
> "JavaScript真题题库")********************************
>
> **【华为od机试真题Java】： ** ** ** ** ** ** ** ** ** ** ** ** ** **
> **[Java真题题库](https://blog.csdn.net/misayaaaaa/category_12111006.html
> "Java真题题库")********************************
>
> **【华为od机试真题C++】： ** ** ** ** ** ** ** ** ** ** ** ** ** **
> **[C++真题题库](https://blog.csdn.net/misayaaaaa/category_12036814.html
> "C++真题题库")********************************
>
> **【华为od机试真题C语言】： ** ** ** ** ** ** ** ** ** ** ** ** ** **
> **[C语言真题题库](https://blog.csdn.net/misayaaaaa/category_12217917.html
> "C语言真题题库")********************************
>
> **【华为od面试手撕代码题库】： ** ** ** ** ** ** ** ** ** ** ** ** ** **
> **[面试手撕代码题库](https://renjie.blog.csdn.net/article/details/130419388
> "面试手撕代码题库")********************************

